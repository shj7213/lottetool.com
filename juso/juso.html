<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="juso.css">
    <title>ìš°í¸ë²ˆí˜¸ ê²€ìƒ‰</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7426134939410178"
     crossorigin="anonymous"></script>
    
    
    
    <script type="text/JavaScript" src="jquery-3.2.1.min.js" ></script>
    <script language="javascript">


        
        function getAddrLoc(){
            // ì ìš©ì˜ˆ (api í˜¸ì¶œ ì „ì— ê²€ìƒ‰ì–´ ì²´í¬) 	
            if (!checkSearchedWord(document.form.keyword)) {
                return ;
            }
        
            $.ajax({
                 url :"https://business.juso.go.kr/addrlink/addrLinkApi.do"
                ,type:"post"
                ,data:$("#form").serialize()
                ,dataType:"xml"
                ,success:function(xmlStr){
                    $("#list").html("");
                    var errCode = $(xmlStr).find("errorCode").text();
                    var errDesc = $(xmlStr).find("errorMessage").text();
                    if(errCode != "0"){
                        alert(errCode+"="+errDesc);
                    }else{
                        if(xmlStr != null){
                            makeList(xmlStr);
                        }
                    }
                }
                ,error: function(xhr,status, error){
                    alert("ì—ëŸ¬ë°œìƒ");
                }
            });
        }
        
        function makeList(xmlStr){
            var htmlStr = "";
            htmlStr += "<table><thead  bgcolor= pink ><tr><th>ìš°í¸ë²ˆí˜¸</th><th>ë„ë¡œëª…ì£¼ì†Œ</th><th>ì§€ë²ˆì£¼ì†Œ</th></tr></thead>";
            $(xmlStr).find("juso").each(function(){
                htmlStr += "<tr>";
                    htmlStr += "<td>"+$(this).find('zipNo').text()+"</td>";
                htmlStr += "<td>"+$(this).find('roadAddr').text()+"</td>";
                //htmlStr += "<td>"+$(this).find('roadAddrPart1').text()+"</td>";
                //htmlStr += "<td>"+$(this).find('roadAddrPart2').text()+"</td>";
                htmlStr += "<td>"+$(this).find('jibunAddr').text()+"</td>";
                //htmlStr += "<td>"+$(this).find('engAddr').text()+"</td>";
                
                //htmlStr += "<td>"+$(this).find('admCd').text()+"</td>";
                //htmlStr += "<td>"+$(this).find('rnMgtSn').text()+"</td>";
                //htmlStr += "<td>"+$(this).find('bdMgtSn').text()+"</td>";
                //htmlStr += "<td>"+$(this).find('detBdNmList').text()+"</td>";
                /** API ì„œë¹„ìŠ¤ ì œê³µí•­ëª© í™•ëŒ€ (2017.02) **/
                //htmlStr += "<td>"+$(this).find('bdNm').text()+"</td>";
                //htmlStr += "<td>"+$(this).find('bdKdcd').text()+"</td>";
                //htmlStr += "<td>"+$(this).find('siNm').text()+"</td>";
                //htmlStr += "<td>"+$(this).find('sggNm').text()+"</td>";
                //htmlStr += "<td>"+$(this).find('emdNm').text()+"</td>";
                //htmlStr += "<td>"+$(this).find('liNm').text()+"</td>";
                //htmlStr += "<td>"+$(this).find('rn').text()+"</td>";
                //htmlStr += "<td>"+$(this).find('udrtYn').text()+"</td>";
                //htmlStr += "<td>"+$(this).find('buldMnnm').text()+"</td>";
                //htmlStr += "<td>"+$(this).find('buldSlno').text()+"</td>";
                //htmlStr += "<td>"+$(this).find('mtYn').text()+"</td>";
                //htmlStr += "<td>"+$(this).find('lnbrMnnm').text()+"</td>";
                //htmlStr += "<td>"+$(this).find('lnbrSlno').text()+"</td>";
                //htmlStr += "<td>"+$(this).find('emdNo').text()+"</td>";
                htmlStr += "</tr>";
            });
            htmlStr += "</table>";
            $("#list").html(htmlStr);
        }
        
        //íŠ¹ìˆ˜ë¬¸ì, íŠ¹ì •ë¬¸ìì—´(sqlì˜ˆì•½ì–´ì˜ ì•ë’¤ê³µë°±í¬í•¨) ì œê±°
        function checkSearchedWord(obj){
            if(obj.value.length >0){
                //íŠ¹ìˆ˜ë¬¸ì ì œê±°
                var expText = /[%=><]/ ;
                if(expText.test(obj.value) == true){
                    alert("íŠ¹ìˆ˜ë¬¸ìë¥¼ ì…ë ¥ í• ìˆ˜ ì—†ìŠµë‹ˆë‹¤.") ;
                    obj.value = obj.value.split(expText).join(""); 
                    return false;
                }
                
                //íŠ¹ì •ë¬¸ìì—´(sqlì˜ˆì•½ì–´ì˜ ì•ë’¤ê³µë°±í¬í•¨) ì œê±°
                var sqlArray = new Array(
                    //sql ì˜ˆì•½ì–´
                    "OR", "SELECT", "INSERT", "DELETE", "UPDATE", "CREATE", "DROP", "EXEC",
                              "UNION",  "FETCH", "DECLARE", "TRUNCATE" 
                );
                
                var regex;
                for(var i=0; i<sqlArray.length; i++){
                    regex = new RegExp( sqlArray[i] ,"gi") ;
                    
                    if (regex.test(obj.value) ) {
                        alert("\"" + sqlArray[i]+"\"ì™€(ê³¼) ê°™ì€ íŠ¹ì •ë¬¸ìë¡œ ê²€ìƒ‰í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
                        obj.value =obj.value.replace(regex, "");
                        return false;
                    }
                }
            }
            return true ;
        }
        
        function enterSearch() {
            var evt_code = (window.netscape) ? ev.which : event.keyCode;
            if (evt_code == 13) {    
                event.keyCode = 0;  
                getAddrLoc(); 
            } 
        }
        </script>
        <title>Insert title here</title>
        </head>
        <body>
            <h3>ğŸ’ì£¼ì†Œê²€ìƒ‰ 87.5</h3>
            <P>â€»ì§€ë²ˆì£¼ì†Œ, ë„ë¡œëª…ì£¼ì†Œ, ìš°í¸ë²ˆí˜¸ ì•„ë¬´ê±°ë‚˜ ê²€ìƒ‰ </P>
            <P>ê²€ìƒ‰ì—ì„œ ë‚˜ì˜¤ëŠ” ê°’ì€ 100ê°œê°€ ìµœëŒ€ì…ë‹ˆë‹¤. ì¡°ê¸ˆ ë” ìƒì„¸í•˜ê²Œ ê²€ìƒ‰ í•´ë³´ì„¸ìš”!</P>
        <form name="form" id="form"method="post">
        <input type="text" name="currentPage"  style="width:250px;display:none" value="1"/>  <!--ìš”ì²­ ë³€ìˆ˜ ì„¤ì • (í˜„ì¬ í˜ì´ì§€. currentPage : n > 0) -->
        <input type="text" name="countPerPage" style="width:250px;display:none" value="100"/> <!-- ìš”ì²­ ë³€ìˆ˜ ì„¤ì • (í˜ì´ì§€ë‹¹ ì¶œë ¥ ê°œìˆ˜. countPerPage ë²”ìœ„ : 0 < n <= 100) --> 
        <input type="text" name="confmKey" id="confmKey" style="width:250px;display:none" value="U01TX0FVVEgyMDI0MDgyNDE1MTIzNTExNTAzMzc="/><!-- ìš”ì²­ ë³€ìˆ˜ ì„¤ì • (ìŠ¹ì¸í‚¤) -->
        <input type="text" name="keyword" style="font-size: 18px; height: 25px;" value="" onkeydown="enterSearch();"/><!-- ìš”ì²­ ë³€ìˆ˜ ì„¤ì • (í‚¤ì›Œë“œ) -->
        <input type="button" onClick="getAddrLoc();" style="height: 30px;" value="ì£¼ì†Œê²€ìƒ‰í•˜ê¸°"/>
        <br>
        <p></p>
        <div id="list" ></div><!-- ê²€ìƒ‰ ê²°ê³¼ ë¦¬ìŠ¤íŠ¸ ì¶œë ¥ ì˜ì—­ -->
        </form>
        </body>
        </html> 	
